@Entity
@Table(name = "employees")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Employee {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    @Column(name = "employee_id")
    private UUID employeeId;

    private String name;

    @Column(unique = true, nullable = false)
    private String email;

    private LocalDateTime dob;

    private String city;

    @Column(name = "phone_number")
    private String phoneNumber;

    private String address;

    @Column(name = "joining_date")
    private LocalDateTime joiningDate;

    /* ================= ORG STRUCTURE ================= */

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "department_id", nullable = false)
    private Department department;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "manager_id")
    private Employee manager;

    /* ================= AUTH LINK ================= */

    @OneToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id", nullable = false, unique = true)
    private User user;

    /* ================= GAME PREFERENCES ================= */

    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(
        name = "employee_game_preferences",
        joinColumns = @JoinColumn(name = "employee_id"),
        inverseJoinColumns = @JoinColumn(name = "game_id")
    )
    private Set<Game> gamePreferences = new HashSet<>();

    /* ================= AUDIT ================= */

    private LocalDateTime createdAt;
    private UUID createdBy;
    private LocalDateTime updatedAt;
    private UUID updatedBy;
}


































@Entity
@Table(name = "games")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Game {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    @Column(name = "game_id")
    private UUID gameId;

    @Column(nullable = false, unique = true)
    private String gameName;

    private boolean active = true;

    @ManyToMany(mappedBy = "gamePreferences")
    private Set<Employee> interestedEmployees = new HashSet<>();
}































@Entity
@Table(name = "game_time_slot_config")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class GameTimeSlotConfig {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID configId;

    @ManyToOne
    @JoinColumn(name = "game_id", nullable = false)
    private Game game;

    private LocalTime workingStartTime;
    private LocalTime workingEndTime;

    private int slotDurationMinutes;   // e.g. 30
    private int maxPlayers;             // e.g. 4

    private boolean active = true;

    private LocalDateTime createdAt;
    private UUID createdBy;
}




























@Entity
@Table(name = "time_slots",
       uniqueConstraints = {
           @UniqueConstraint(columnNames = {"game_id", "slot_date", "start_time"})
       })
@Data
@NoArgsConstructor
@AllArgsConstructor
public class TimeSlot {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID timeSlotId;

    @ManyToOne
    @JoinColumn(name = "game_id", nullable = false)
    private Game game;

    @Column(name = "slot_date", nullable = false)
    private LocalDate slotDate;

    @Column(name = "start_time", nullable = false)
    private LocalTime startTime;

    @Column(name = "end_time", nullable = false)
    private LocalTime endTime;
}


































@Entity
@Table(name = "game_bookings")
@Data
@NoArgsConstructor
@AllArgsConstructor
public class GameBooking {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID gameBookingId;

    @ManyToOne
    @JoinColumn(name = "time_slot_id", nullable = false)
    private TimeSlot timeSlot;

    @ManyToOne
    @JoinColumn(name = "game_id", nullable = false)
    private Game game;

    // BOOKER
    @ManyToOne
    @JoinColumn(name = "booker_id", nullable = false)
    private Employee booker;

    @Enumerated(EnumType.STRING)
    private BookingStatus bookingStatus; // CONFIRMED, CANCELLED

    private LocalDateTime bookingStartTime;
    private LocalDateTime cancellationCutoffTime;

    private LocalDateTime createdAt;
}




























@Entity
@Table(name = "booking_members",
       uniqueConstraints = {
           @UniqueConstraint(columnNames = {"game_booking_id", "employee_id"})
       })
@Data
@NoArgsConstructor
@AllArgsConstructor
public class BookingMember {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID bookingMemberId;

    @ManyToOne
    @JoinColumn(name = "game_booking_id", nullable = false)
    private GameBooking gameBooking;

    @ManyToOne
    @JoinColumn(name = "employee_id", nullable = false)
    private Employee employee;

    private LocalDateTime joinedAt;
}




































@Entity
@Table(name = "game_waiting_queue",
       uniqueConstraints = {
           @UniqueConstraint(columnNames = {"time_slot_id", "employee_id"})
       })
@Data
@NoArgsConstructor
@AllArgsConstructor
public class GameWaitingQueue {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID queueId;

    @ManyToOne
    @JoinColumn(name = "time_slot_id", nullable = false)
    private TimeSlot timeSlot;

    @ManyToOne
    @JoinColumn(name = "game_id", nullable = false)
    private Game game;

    @ManyToOne
    @JoinColumn(name = "employee_id", nullable = false)
    private Employee employee;

    @Enumerated(EnumType.STRING)
    private QueueStatus status; // WAITING, ALLOCATED, CANCELLED

    private LocalDateTime joinedAt;
}

























@Entity
@Table(name = "game_play_stats",
       uniqueConstraints = {
           @UniqueConstraint(columnNames = {"employee_id", "game_id"})
       })
@Data
@NoArgsConstructor
@AllArgsConstructor
public class GamePlayStats {

    @Id
    @GeneratedValue(strategy = GenerationType.UUID)
    private UUID statsId;

    @ManyToOne
    @JoinColumn(name = "employee_id", nullable = false)
    private Employee employee;

    @ManyToOne
    @JoinColumn(name = "game_id", nullable = false)
    private Game game;

    private int completedSlots;

    private LocalDateTime lastPlayedAt;
}
