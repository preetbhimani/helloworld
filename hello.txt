@PostMapping("/{id}/photo")
public ResponseEntity<Map<String, String>> uploadEmployeePhoto(
        @PathVariable UUID id,
        @RequestParam("file") MultipartFile file) throws IOException {

    String fileName = employeeService.uploadEmployeePhoto(id, file);

    Map<String, String> response = new HashMap<>();
    response.put("message", "Photo uploaded successfully");
    response.put("fileName", fileName);

    return ResponseEntity.ok(response); // simple 200 OK
}










public String uploadEmployeePhoto(UUID id, MultipartFile file) throws IOException {

    // 1. Find employee
    Employee employee = employeeRepo.findById(id)
            .orElseThrow(() -> new ResourceNotFoundException("Employee not found"));

    // 2. Save image to local drive
    String fileName = saveImageToLocal(file);

    // 3. Save filename/path in DB
    employee.setPhoto(fileName);
    employeeRepo.save(employee);

    return fileName;
}




@Value("${file.upload-dir}")
private String uploadDir;

private String saveImageToLocal(MultipartFile file) throws IOException {

    Path uploadPath = Paths.get(uploadDir);
    if (!Files.exists(uploadPath)) {
        Files.createDirectories(uploadPath);
    }

    String fileName = System.currentTimeMillis() + "_" + file.getOriginalFilename();
    Path filePath = uploadPath.resolve(fileName);

    Files.copy(file.getInputStream(), filePath, StandardCopyOption.REPLACE_EXISTING);

    return fileName; // store ONLY file name in DB
}
